<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ReClaim It | Smart Matching System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
--primary:#6366F1;
--accent:#22D3EE;
--bg:#0b0f1a;
--card:rgba(255,255,255,.05);
--border:rgba(255,255,255,.08);
--text:#f8fafc;
--muted:#9ca3af;
--success:#10B981;
--warning:#F59E0B;
--danger:#EF4444;
--glass:rgba(255,255,255,.03);
}

*{box-sizing:border-box;margin:0;padding:0;font-family:'Plus Jakarta Sans',sans-serif}

body{
display:flex;
min-height:100vh;
background:
radial-gradient(circle at 20% 0%,rgba(99,102,241,.35),transparent 40%),
radial-gradient(circle at 90% 100%,rgba(34,211,238,.25),transparent 40%),
var(--bg);
color:var(--text);
}

/* SIDEBAR */
.sidebar{
width:250px;
background:var(--glass);
backdrop-filter:blur(20px);
border-right:1px solid var(--border);
padding:28px 20px;
display:flex;
flex-direction:column;
}

.logo{font-size:22px;font-weight:800;margin-bottom:30px}
.logo b{
background:linear-gradient(90deg,var(--accent),var(--primary));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

.menu small{color:var(--muted);font-size:11px;margin:18px 0 8px;display:block;letter-spacing:.08em}

.menu a{
display:flex;align-items:center;gap:10px;padding:12px 14px;border-radius:12px;
color:#cbd5e1;text-decoration:none;font-size:14px;margin-bottom:6px;transition:.25s
}
.menu a:hover{background:rgba(99,102,241,.15);color:white}
.menu a.active{background:linear-gradient(135deg,var(--primary),#4F46E5);color:white}

/* MAIN */
.main-content{flex:1;padding:50px}

/* HEADER */
.page-header{text-align:center;margin-bottom:40px}
.page-header h1{
font-size:42px;font-weight:800;
background:linear-gradient(90deg,#fff,#93C5FD);
-webkit-background-clip:text;-webkit-text-fill-color:transparent;
}

/* CONTROLS */
.controls-bar{
max-width:1200px;margin:0 auto 30px;
display:flex;flex-wrap:wrap;gap:15px;align-items:center;justify-content:space-between;
}

.search-box{
flex:1;max-width:300px;
padding:14px 20px;border-radius:12px;
background:var(--glass);border:1px solid var(--border);
color:var(--text);font-size:14px;
}
.search-box::placeholder{color:var(--muted)}
.search-box:focus{outline:none;border-color:var(--primary);background:rgba(255,255,255,.08)}

.filter-select,.export-btn{
padding:14px 20px;border-radius:12px;border:none;
background:var(--glass);color:var(--text);font-weight:600;cursor:pointer;
border:1px solid var(--border);transition:.25s;
}
.filter-select:focus,.export-btn:hover{outline:none;border-color:var(--primary)}

.ai-scan-btn{
padding:18px 32px;border-radius:16px;border:none;
background:linear-gradient(135deg,var(--primary),#4F46E5);
color:white;font-weight:700;font-size:16px;cursor:pointer;
transition:.3s;box-shadow:0 20px 40px rgba(99,102,241,.3);
}
.ai-scan-btn:hover{transform:translateY(-4px);box-shadow:0 30px 60px rgba(99,102,241,.4)}
.ai-scan-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none}

/* STATS & PLAN */
.stats-grid,.plan-display{
background:var(--glass);
backdrop-filter:blur(25px);
border-radius:20px;
border:1px solid var(--border);
}

.stats-grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
gap:20px;
max-width:800px;margin:0 auto 30px;
}
.stats-card{padding:30px;text-align:center;transition:.25s}
.stats-card:hover{transform:translateY(-5px)}
.stats-number{font-size:36px;font-weight:800;margin-bottom:8px}

.plan-display{
max-width:400px;margin:0 auto 30px;padding:25px;text-align:center;
}

/* TABLE CONTAINER */
.table-container{
max-width:1200px;margin:0 auto;
background:var(--glass);
backdrop-filter:blur(25px);
border-radius:26px;
padding:40px;
border:1px solid var(--border);
overflow:hidden;box-shadow:0 25px 50px rgba(0,0,0,.3);
}

table{width:100%;border-collapse:collapse;font-size:14px}
th{
padding:20px 12px;font-weight:700;color:var(--text);text-align:left;
border-bottom:1px solid var(--border);cursor:pointer;position:relative;
transition:.25s;
}
th:hover{background:rgba(99,102,241,.1)}
th.sorted-asc::after,th.sorted-desc::before{content:' ';position:absolute;right:12px;top:50%;width:0;height:0;border:5px solid transparent}
th.sorted-asc::after{border-bottom-color:var(--accent);margin-top:-10px}
th.sorted-desc::before{border-top-color:var(--accent);margin-top:0}

td{padding:16px 12px;border-bottom:1px solid rgba(255,255,255,.05);vertical-align:middle}

.status-badge{
padding:8px 16px;border-radius:20px;font-size:12px;font-weight:600;
min-width:90px;text-align:center;display:inline-block;
}
.status-lost{background:rgba(239,68,68,.2);color:#FCA5A5;border:1px solid rgba(239,68,68,.3)}
.status-found{background:rgba(16,185,129,.2);color:#6EE7B7;border:1px solid rgba(16,185,129,.3)}
.status-matched{background:linear-gradient(135deg,var(--primary),#4F46E5);color:white}
.status-pending{background:rgba(245,158,11,.2);color:#FCD34D;border:1px solid rgba(245,158,11,.3)}
.status-claimed{background:var(--success);color:white}

.action-btn{
padding:10px 18px;border:none;border-radius:10px;font-size:12px;font-weight:600;
cursor:pointer;transition:.25s;margin-right:8px;margin-bottom:4px;
min-width:80px;
}
.btn-claim{background:var(--success);color:white}
.btn-claim:hover{transform:scale(1.05);box-shadow:0 5px 15px rgba(16,185,129,.4)}
.btn-view{background:var(--accent);color:white}
.btn-view:hover{transform:scale(1.05)}
.btn-delete{background:var(--danger);color:white}
.btn-delete:hover{transform:scale(1.05)}

@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}
@keyframes glow{0%,100%{box-shadow:0 0 20px rgba(99,102,241,.5)}50%{box-shadow:0 0 40px rgba(99,102,241,.8)}}
.scanning{animation:pulse 1.5s infinite}
.matched-glow{animation:glow 2s infinite}

@media(max-width:768px){
body{flex-direction:column}
.sidebar{width:100%;padding:20px}
.main-content{padding:30px 20px}
.page-header h1{font-size:32px}
.controls-bar{flex-direction:column;align-items:stretch}
.ai-scan-btn,.search-box{width:100%}
table{font-size:12px}
th,td{padding:12px 8px}
.action-btn{padding:8px 12px;font-size:11px;min-width:auto}
}
</style>
</head>


    <aside class="sidebar">
        <div class="logo-container">
            <img src="download.svg" alt="Logo" class="app-logo" onerror="this.style.display='none'">
            <div class="logo">Re<b>Claim</b> It</div>
        </div>

        <nav class="menu">
            <small>Main</small>
            <a href="dashboard.html">üìä Dashboard</a>
            <a href="project.html">üè† Home</a>
            <a href="report.html">üìÑ Report</a>
            <a href="found.html">üîé Founder</a>
            <a href="pricing.html" class="active">üí≥ Payment</a>
            <a href="item.html">üì¶ Item Report</a>
          
          
            <small>Resources</small>
            <a href="about.html">‚Ñπ About</a>
            <a href="help.html">‚ùì Help</a>
            <a href="login.html" style="margin-top: auto; color: #ef4444;">üö™ Logout</a>
        </nav>
    </aside>

<main class="main-content">
<div class="page-header">
<h1><i class="fas fa-brain"></i> Smart Matching System</h1>
<p style="color:var(--muted);font-size:18px">AI-powered matching between lost & found items across Madurai</p>
</div>

<!-- Plan Display -->
<div class="plan-display" id="planDisplay">
<i class="fas fa-crown" style="color:var(--success);font-size:24px;margin-bottom:10px"></i>
<p style="color:var(--muted)">Your Plan:</p>
<h3 id="currentPlan">Loading...</h3>
<p id="scanLimit" style="color:var(--muted);font-size:14px">Scans available: Unlimited</p>
</div>

<!-- Controls -->
<div class="controls-bar">
<input type="text" class="search-box" id="searchBox" placeholder="üîç Search items, users, locations...">
<select class="filter-select" id="filterSelect">
<option value="">All Status</option>
<option value="Pending">Pending</option>
<option value="Matched">Matched</option>
<option value="Claimed">Claimed</option>
</select>
<button class="export-btn" onclick="exportData()" title="Export to CSV"><i class="fas fa-download"></i> Export</button>
<button class="ai-scan-btn" id="scanBtn" onclick="runAI()">
<i class="fas fa-rocket"></i> Run AI Matching Scan
</button>
</div>

<!-- Stats -->
<div class="stats-grid" id="statsGrid">
<div class="stats-card">
<div class="stats-number" data-stat="matches" style="color:var(--success)">0</div>
<div><i class="fas fa-check-circle"></i> Total Matches</div>
</div>
<div class="stats-card">
<div class="stats-number" data-stat="pending" style="color:var(--primary)">0</div>
<div><i class="fas fa-clock"></i> Pending Items</div>
</div>
<div class="stats-card">
<div class="stats-number" data-stat="avgScore" style="color:var(--accent)">95%</div>
<div><i class="fas fa-percentage"></i> Avg Match Score</div>
</div>
<div class="stats-card">
<div class="stats-number" data-stat="total" style="color:var(--text)">0</div>
<div><i class="fas fa-database"></i> Total Items</div>
</div>
</div>

<!-- Results Table -->
<div class="table-container">
<table id="matchesTable">
<thead>
<tr>
<th data-sort="item"><i class="fas fa-box"></i> Item</th>
<th data-sort="brand"><i class="fas fa-tag"></i> Brand/Color</th>
<th data-sort="location"><i class="fas fa-map-marker-alt"></i> Location</th>
<th data-sort="user"><i class="fas fa-user"></i> User</th>
<th data-sort="type"><i class="fas fa-exchange-alt"></i> Type</th>
<th data-sort="matchScore"><i class="fas fa-star"></i> Match Score</th>
<th data-sort="status"><i class="fas fa-info-circle"></i> Status</th>
<th>Action</th>
</tr>
</thead>
<tbody id="tableBody">
<tr><td colspan="8" style="text-align:center;color:var(--muted);padding:80px">
<i class="fas fa-brain" style="font-size:48px;margin-bottom:20px;opacity:0.5"></i>
<br>Run AI scan to discover matches
</td></tr>
</tbody>
</table>
</div>
</main>

<script>
// =======================
// ENHANCED DATABASE
// =======================
const dummyItems = [
{item:"iPhone 15 Pro Max",brand:"Apple",color:"Black Titanium",location:"Madurai Meenakshi Temple"},
{item:"iPhone 15 Pro",brand:"Apple",color:"Natural Titanium",location:"Temple Gate Bus Stop"},
{item:"Samsung Galaxy S24 Ultra",brand:"Samsung",color:"Titanium Silver",location:"Madurai Railway Station"},
{item:"Samsung Galaxy S23",brand:"Samsung",color:"Silver",location:"Platform 3"},
{item:"Brown Leather Wallet",brand:"Generic",color:"Brown",location:"Periyar Mall"},
{item:"Black Leather Wallet",brand:"Generic",color:"Brown",location:"Market Street"},
{item:"Rolex Submariner",brand:"Rolex",color:"Gold",location:"Gandhi Museum"},
{item:"Gold Bracelet 18K",brand:"Generic",color:"Gold",location:"Jewelry Street"},
{item:"AirPods Pro 2",brand:"Apple",color:"White",location:"Madurai Airport Lounge"},
{item:"AirPods Case",brand:"Apple",color:"White",location:"Security Check"},
{item:"Ray-Ban Sunglasses",brand:"Ray-Ban",color:"Black",location:"Meenakshi Temple"},
{item:"Oakley Sunglasses",brand:"Oakley",color:"Black",location:"Temple Entrance"},
{item:"Laptop Bag",brand:"Dell",color:"Black",location:"Railway Station"},
{item:"MacBook Charger",brand:"Apple",color:"White",location:"Platform 1"}
];

let database = [];
let sortConfig = {key: null, direction: 'asc'};
let filterStatus = '';
let searchTerm = '';

// =======================
// DATA OPERATIONS
// =======================
function loadData(){
const saved = localStorage.getItem("reclaim_db");
if(saved){
database = JSON.parse(saved);
} else {
    for(let i = 0; i < 40; i++){
        const base = dummyItems[Math.floor(i/3) % dummyItems.length];
        database.push({
            id: Date.now() + i,
            item: base.item + (i%3 ? ` #${i+1}` : ''),
            brand: base.brand,
            color: base.color,
            location: base.location,
            type: i%2 === 0 ? "Lost" : "Found",
            user: i%2 === 0 ? `User ${i+1}` : `Finder ${i+1}`,
            phone: `+91 98${String(Math.floor(1000000 + i*1000)).slice(-7)}`,
            matchScore: 0,
            status: "Pending",
            partner: "",
            matched: false,
            timestamp: Date.now() - (i*3600000)
        });
    }
    saveData();
}
updateStats();
}

function saveData(){
localStorage.setItem("reclaim_db", JSON.stringify(database));
}

// =======================
// PLAN SYSTEM
// =======================
function loadPlan(){
const plan = JSON.parse(localStorage.getItem('userPlan')) || {name: 'Basic', price: 99};
const planEl = document.getElementById('currentPlan');
planEl.textContent = `${plan.name} Plan (‚Çπ${plan.price}/mo)`;
planEl.parentElement.style.borderLeft = plan.name === 'Premium' ? '4px solid var(--success)' : '4px solid var(--primary)';
document.getElementById('scanLimit').textContent = plan.name === 'Premium' ? '‚úÖ Unlimited Scans' : '‚ö° 5 Scans/Day';
}

// =======================
// SORTING SYSTEM
// =======================
function render(filteredData = null){
const data = filteredData || database;
const body = document.getElementById("tableBody");
body.innerHTML = "";

if(data.length === 0){
body.innerHTML = '<tr><td colspan="8" style="text-align:center;color:var(--muted);padding:80px"><i class="fas fa-inbox" style="font-size:48px;margin-bottom:20px;opacity:0.5"></i><br>No items match your filter</td></tr>';
return;
}

data.slice(0, 25).forEach((item) => {
    const globalIndex = database.indexOf(item);
    body.innerHTML += `
        <tr>
            <td style="font-weight:600">${item.item}</td>
            <td>${item.brand}<br><small style="color:var(--muted)">${item.color}</small></td>
            <td style="max-width:180px"><i class="fas fa-map-marker-alt" style="color:var(--accent);margin-right:5px"></i>${item.location}</td>
            <td>${item.user}<br><small style="color:var(--muted)">${item.phone}</small></td>
            <td><span class="status-badge status-${item.type.toLowerCase()}">${item.type}</span></td>
            <td style="font-weight:700;font-size:16px;color:${item.matchScore >= 80 ? 'var(--success)' : item.matchScore >= 60 ? 'var(--warning)' : 'var(--danger)'}">${item.matchScore}%</td>
            <td><span class="status-badge status-${item.status.toLowerCase()}">${item.status}</span></td>
            <td>
                ${item.status === "Matched" ?
                    `<button class="action-btn btn-claim" onclick="claimItem(${globalIndex})"><i class="fas fa-check"></i> Claim</button>` :
                    `<button class="action-btn btn-view" onclick="viewDetails(${globalIndex})"><i class="fas fa-eye"></i> View</button>
                     <button class="action-btn btn-delete" onclick="deleteItem(${globalIndex})"><i class="fas fa-trash"></i> Delete</button>`
                }
            </td>
        </tr>`;
});
updateSortIndicators();
}

function updateSortIndicators(){
document.querySelectorAll('th[data-sort]').forEach(th => {
    th.classList.remove('sorted-asc', 'sorted-desc');
});
if(sortConfig.key){
    const th = document.querySelector(`th[data-sort="${sortConfig.key}"]`);
    if(th) th.classList.add(`sorted-${sortConfig.direction}`);
}
}

// =======================
// ENHANCED AI ALGORITHM
// =======================
function calculateScore(a, b){
let score = 0;

// Brand (35%)
if(a.brand.toLowerCase() === b.brand.toLowerCase()) score += 35;

// Color similarity (25%)
if(a.color.toLowerCase().includes(b.color.toLowerCase().split(' ')[0]) || 
   b.color.toLowerCase().includes(a.color.toLowerCase().split(' ')[0])) score += 25;

// Item name (30%)
const similarity = itemSimilarity(a.item, b.item);
score += Math.min(similarity * 30, 30);

// Location (10%)
if(a.location.toLowerCase().includes(b.location.toLowerCase().split(' ')[0]) || 
   b.location.toLowerCase().includes(a.location.toLowerCase().split(' ')[0])) score += 10;

return Math.round(Math.min(score, 100));
}

function itemSimilarity(str1, str2) {
const words1 = str1.toLowerCase().split(' ').filter(w => w.length > 2);
const words2 = str2.toLowerCase().split(' ').filter(w => w.length > 2);
let matches = 0;
words1.forEach(word1 => {
    words2.forEach(word2 => {
        if(word1.includes(word2) || word2.includes(word1)) matches++;
    });
});
return Math.min(matches / Math.max(words1.length, words2.length), 1);
}

// =======================
// AI SCAN
// =======================
function runAI(){
const btn = document.getElementById('scanBtn');
const plan = JSON.parse(localStorage.getItem('userPlan')) || {name: 'Basic'};
if(plan.name !== 'Premium' && scanCount >= 5){
    alert('‚ö†Ô∏è Daily scan limit reached. Upgrade to Premium for unlimited scans!');
    return;
}

btn.disabled = true;
btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Scanning...';
btn.classList.add('scanning');

let matchesFound = 0;

// Reset matches
database.forEach(item => {
    item.matched = false;
    item.status = "Pending";
    item.matchScore = 0;
    item.partner = "";
});

const lostItems = database.filter(item => item.type === "Lost");
const foundItems = database.filter(item => item.type === "Found");

lostItems.forEach(lost => {
    foundItems.forEach(found => {
        if(lost.matched || found.matched) return;
        const score = calculateScore(lost, found);
        if(score >= 75){
            lost.matchScore = score;
            found.matchScore = score;
            lost.status = "Matched";
            found.status = "Matched";
            lost.partner = `${found.user} (${found.phone})`;
            found.partner = `${lost.user} (${lost.phone})`;
            lost.matched = true;
            found.matched = true;
            matchesFound++;
        }
    });
});

scanCount++;
setTimeout(() => {
    saveData();
    updateStats();
    render();
    btn.disabled = false;
    btn.innerHTML = `<i class="fas fa-rocket"></i> Run AI Scan (${matchesFound} new matches)`;
    btn.classList.remove('scanning');
    
    if(matchesFound > 0){
        document.querySelector('.table-container').classList.add('matched-glow');
        setTimeout(() => document.querySelector('.table-container').classList.remove('matched-glow'), 3000);
    }
}, 2500);
}

// =======================
// ACTIONS
// =======================
function claimItem(index){
const item = database[index];
if(confirm(`Claim this match?\n\nüì± Contact: ${item.partner}\nüéØ Score: ${item.matchScore}%`)){
    item.status = "Claimed";
    item.claimedBy = JSON.parse(localStorage.getItem('userPlan') || '{}').name || 'User';
    saveData();
    render();
    updateStats();
}
}

function viewDetails(index){
const item = database[index];
alert(`üìã Detailed Information\n\nüë§ Item: ${item.item}\nüè∑Ô∏è Brand: ${item.brand}\nüé® Color: ${item.color}\nüìç Location: ${item.location}\nüë• User: ${item.user}\nüìû Phone: ${item.phone}\n${item.partner ? `ü§ù Partner: ${item.partner}` : ''}\n‚≠ê Score: ${item.matchScore}%\nüìä Status: ${item.status}`);
}

function deleteItem(index){
if(confirm("Delete this item permanently?")){
    database.splice(index, 1);
    saveData();
    render();
    updateStats();
}
}

// =======================
// FILTERING & SEARCH
// =======================
document.getElementById('searchBox').addEventListener('input', function(e){
    searchTerm = e.target.value.toLowerCase();
    applyFilters();
});

document.getElementById('filterSelect').addEventListener('change', function(e){
    filterStatus = e.target.value;
    applyFilters();
});

function applyFilters(){
const filtered = database.filter(item => {
    const matchesSearch = !searchTerm || 
        item.item.toLowerCase().includes(searchTerm) ||
        item.brand.toLowerCase().includes(searchTerm) ||
        item.location.toLowerCase().includes(searchTerm) ||
        item.user.toLowerCase().includes(searchTerm);
    
    const matchesStatus = !filterStatus || item.status === filterStatus;
    
    return matchesSearch && matchesStatus;
});
render(filtered);
}

// =======================
// TABLE SORTING
// =======================
document.querySelectorAll('th[data-sort]').forEach(th => {
    th.addEventListener('click', () => {
        const key = th.dataset.sort;
        if(sortConfig.key === key){
            sortConfig.direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';
        } else {
            sortConfig.key = key;
            sortConfig.direction = 'asc';
        }
        
        database.sort((a, b) => {
            let aVal = a[key] || '';
            let bVal = b[key] || '';
            
            if(key === 'matchScore') {
                aVal = parseInt(aVal) || 0;
                bVal = parseInt(bVal) || 0;
            }
            
            if(sortConfig.direction === 'asc'){
                return aVal > bVal ? 1 : -1;
            } else {
                return aVal < bVal ? 1 : -1;
            }
        });
        
        render();
    });
});

// =======================
// EXPORT FUNCTIONALITY
// =======================
function exportData(){
    const csv = [
        ['ID','Item','Brand','Color','Location','User','Phone','Type','Match Score','Status','Partner'],
        ...database.map(item => [
            item.id,
            `"${item.item}"`,
            item.brand,
            item.color,
            `"${item.location}"`,
            item.user,
            item.phone,
            item.type,
            item.matchScore,
            item.status,
            `"${item.partner || ''}"`
        ])
    ].map(row => row.join(',')).join('\n');
    
    const blob = new Blob([csv], {type: 'text/csv'});
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ReClaim_Matches_${new Date().toISOString().slice(0,10)}.csv`;
    a.click();
    window.URL.revokeObjectURL(url);
}

// =======================
// STATS UPDATE
// =======================
function updateStats(){
const matches = database.filter(item => item.status === "Matched").length;
const pending = database.filter(item => item.status === "Pending").length;
const claimed = database.filter(item => item.status === "Claimed").length;
const avgScore = database.filter(item => item.matchScore > 0).reduce((sum, item) => sum + item.matchScore, 0) / 
                 (database.filter(item => item.matchScore > 0).length || 1);

document.querySelector('[data-stat="matches"]').textContent = matches;
document.querySelector('[data-stat="pending"]').textContent = pending;
document.querySelector('[data-stat="avgScore"]').textContent = `${Math.round(avgScore)}%`;
document.querySelector('[data-stat="total"]').textContent = database.length;
}

// =======================
// INITIALIZATION
// =======================
document.addEventListener('DOMContentLoaded', function(){
    loadData();
    loadPlan();
    render();
});
</script>
</body>
</html>
